---
import Bluesky from "./icons/bluesky.astro";
import Github from "./icons/github.astro";
import Threads from "./icons/threads.astro";
import X from "./icons/x.astro";
---

<footer
    class="mt-20 flex flex-row gap-px w-full overflow-hidden border-t border-neutral-700"
>
    <div class="hidden lg:flex outline outline-neutral-700 w-20 shrink-0"></div>
    <div class="flex py-10 outline outline-neutral-700 flex-1 min-w-0 flex-col">
        <div
            class="flex px-5 flex-col lg:flex-row justify-between w-full items-start gap-8"
        >
            <div
                class="flex flex-col md:flex-row md:space-x-12 space-y-8 md:space-y-0 mb-10 lg:mb-20 z-40 w-full lg:w-auto"
            >
                <div class="flex footer-container flex-col space-y-2">
                    <span class="text-sm text-neutral-400 mb-1">Features</span>
                    <a
                        href="/features/workflows"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Workflows
                    </a>
                    <a
                        href="/features/api"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        API
                    </a>
                    <a
                        href="/features/ai"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        AI
                    </a>
                    <a
                        href="/features/security"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Security
                    </a>

                    <a
                        href="https://selfmail.dev"
                        target="_blank"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        <span class="flex flex-row items-center space-x-1">
                            <span>Developers</span>
                            <span class="text-neutral-400 font-bold text-xs"
                                >↗</span
                            >
                        </span>
                    </a>
                </div>
                <div class="flex footer-container flex-col space-y-2">
                    <span class="text-sm text-neutral-400 mb-1">Platform</span>
                    <a
                        href="/pricing"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Pricing
                    </a>
                    <a
                        href="/blog"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Blog
                    </a>
                    <a
                        href="https://docs.selfmail.app"
                        target="_blank"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Docs
                    </a>
                    <a
                        href="/features"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Features
                    </a>
                </div>
                <div class="flex footer-container flex-col space-y-2">
                    <span class="text-sm text-neutral-400 mb-1">Legal</span>
                    <a
                        href="/privacy"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Privacy
                    </a>
                    <a
                        href="/terms"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Terms
                    </a>
                    <a
                        href="/imprint"
                        class="footer-link text-lg hover:text-neutral-300 transition-colors relative group"
                    >
                        Imprint
                    </a>
                </div>
            </div>
            <div
                class="survey-box z-40 relative overflow-hidden outline-1 outline-neutral-700 p-6 w-full lg:max-w-md"
            >
                <div class="grid-glow glow-amber"></div>
                <div class="relative z-10">
                    <h3 class="text-2xl font-bold mb-3 text-neutral-100">
                        What are your problems with Email?
                    </h3>
                    <p class="text-neutral-300 mb-4">
                        We are running a survey to understand the biggest pain
                        points of communication via Email. Attend this journey
                        and help us improve the future of email.
                    </p>
                    <a
                        href="/survey"
                        class="inline-block bg-neutral-100 text-black px-6 py-2 rounded-full hover:bg-neutral-200 transition-all hover:scale-105"
                    >
                        Take Survey →
                    </a>
                </div>
            </div>
        </div>
        <h2
            id="selfmail-title"
            class="opacity-30 font-bold mb-8 whitespace-nowrap"
            style="line-height: 0.9;"
        >
            Selfmail
        </h2>
        <div class="w-full grid grid-cols-4 gap-px">
            <div class="relative h-24 outline outline-neutral-700">
                <a
                    href="https://github.com/selfmail/selfmail"
                    class="outline space-x-3 hover:bg-neutral-900 transition-colors text-xl outline-neutral-700 flex items-center justify-center rounded-full absolute inset-0"
                >
                    <Github class:list={"h-5 w-5"} />
                    <span>GitHub</span>
                </a>
            </div>
            <div class="relative outline outline-neutral-700">
                <a
                    href="https://github.com/selfmail/selfmail"
                    class="outline space-x-3 hover:bg-neutral-900 transition-colors text-xl outline-neutral-700 flex items-center justify-center rounded-full absolute inset-0"
                >
                    <Threads class:list={"h-5 w-5"} />
                    <span>Threads</span>
                </a>
            </div>
            <div class="relative outline outline-neutral-700">
                <a
                    href="https://x.com/useselfmail"
                    class="outline space-x-3 hover:bg-neutral-900 transition-colors text-xl outline-neutral-700 flex items-center justify-center rounded-full absolute inset-0"
                >
                    <X class:list={"h-5 w-5"} />
                    <span>(formerly Twitter)</span>
                </a>
            </div>
            <div class="relative outline outline-neutral-700">
                <a
                    href="https://bsky.app/selfmail"
                    class="outline space-x-3 hover:bg-neutral-900 transition-colors text-xl outline-neutral-700 flex items-center justify-center rounded-full absolute inset-0"
                >
                    <Bluesky class:list={"h-5 w-5"} />
                    <span>Bluesky</span>
                </a>
            </div>
            <div class="relative h-24 col-span-4 outline outline-neutral-700">
                <a
                    href="https://selfmail.company"
                    target="_blank"
                    class="outline space-x-3 hover:bg-neutral-900 transition-colors text-xl outline-neutral-700 flex items-center justify-center rounded-full absolute inset-0"
                >
                    <h2 class="text-2xl font-medium">
                        Selfmail is an open-source project by The Selfmail
                        Company.
                    </h2>
                </a>
            </div>
        </div>
    </div>
    <div class="hidden lg:flex outline outline-neutral-700 w-20 shrink-0"></div>
</footer>

<style>
    .survey-box {
        transition: all 0.3s ease;
    }

    .survey-box:hover {
        transform: translateY(-4px);
    }

    .grid-glow {
        position: absolute;
        width: 300px;
        height: 300px;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0;
        transition: opacity 0.9s ease;
        pointer-events: none;
    }

    .glow-amber {
        background: rgba(251, 191, 36, 0.3);
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .survey-box:hover .grid-glow {
        opacity: 1;
    }
</style>

<script>
    const resizeTitle = () => {
        const title = document.getElementById("selfmail-title");
        const container = title?.parentElement;
        if (!title || !container) return;

        const containerWidth = container.clientWidth;
        const containerStyle = window.getComputedStyle(container);
        const paddingLeft = parseFloat(containerStyle.paddingLeft);
        const paddingRight = parseFloat(containerStyle.paddingRight);
        const availableWidth = containerWidth - paddingLeft - paddingRight;

        let low = 10;
        let high = 1000;
        let bestSize = low;

        while (low <= high) {
            const mid = Math.floor((low + high) / 2);
            title.style.fontSize = `${mid}px`;

            void title.offsetHeight;

            const textWidth = title.scrollWidth;

            if (textWidth <= availableWidth) {
                bestSize = mid;
                low = mid + 1;
            } else {
                high = mid - 1;
            }
        }

        title.style.fontSize = `${bestSize}px`;
    };

    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", resizeTitle);
    } else {
        resizeTitle();
    }

    window.addEventListener("resize", resizeTitle);
</script>
