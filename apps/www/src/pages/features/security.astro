---
import Layout from "@/layouts/Layout.astro";
---

<Layout title="Features | Selfmail">
    <main class="w-full flex flex-col">
        <h1 class="text-8xl font-medium mx-20 mt-20">Security</h1>
        <div
            class="h-[70vh] flex flex-row items-center bg-neutral-900 border-y border-y-neutral-700 my-16"
        >
            <div
                class="flex-1 flex-col space-y-3 h-full items-center justify-center flex"
            >
                <div
                    class="text-box border w-[500px] border-neutral-700 p-4 flex flex-col space-y-1"
                    data-index="0"
                >
                    <h2 class="text-xl">Connection Security</h2>
                    <p>
                        Checking common spam patterns right before delivery to
                        ensure safety.
                    </p>
                </div>
                <div
                    class="text-box border w-[500px] border-neutral-700 p-4 flex flex-col space-y-1"
                    data-index="1"
                >
                    <h2 class="text-xl">Spam Control</h2>
                    <p>
                        You can decide what level of spam filtering you want to
                        apply to your inbox, from low to aggressive, filtering
                        with AI.
                    </p>
                </div>
                <div
                    class="text-box border w-[500px] border-neutral-700 p-4 flex flex-col space-y-1"
                    data-index="2"
                >
                    <h2 class="text-xl">In-App Previews</h2>
                    <p>
                        We have created secure sandbox previews for links, files
                        and text to avoid malicious content. You can take
                        screenshots, so you don't have to open the file on your
                        computer.
                    </p>
                </div>
            </div>
            <div
                class="flex-1 layers relative items-center justify-center flex flex-col"
            >
                <div
                    class="feature-dot-layer layer-item rotate-45 h-80 w-80 relative top-10"
                >
                </div>
                <div
                    class="feature-lines-layer layer-item rotate-45 h-80 w-80 absolute"
                >
                </div>
                <div
                    class="feature-grid-layer layer-item rotate-45 h-80 w-80 relative bottom-10"
                >
                </div>
            </div>
        </div>
        <p class="text-neutral-200 mx-20 text-2xl leading-relaxed">
            Security is one of the most important aspects of the current email
            communication. Half of all emails sent are spam, phishing methods
            are getting better and better, and employees are loosing arround 16
            hours filtering spam in a year. Selfmail offers fine-tuned spam
            control, leveraging advanced trained AI models to indentify spam and
            phishing, deleting emails before they can do any harm.
        </p>
        <div class="flex flex-col space-y-3 mt-20">
            <h2 class="text-center text-4xl font-medium">
                Our Security in Numbers
            </h2>

            <div
                class="mx-20 mt-5 grid lg:grid-cols-3 gap-px outline outline-neutral-700"
            >
                <div class="relative outline outline-neutral-700 h-32">
                    <div
                        class="absolute justify-center rounded-full outline outline-neutral-700 inset-0 items-center flex flex-col space-y-1"
                    >
                        <span class="text-4xl font-bold">99.8%</span>
                        <h3 class="text-lg text-neutral-400">
                            Spam Detection Rate
                        </h3>
                    </div>
                </div>
                <div class="relative outline outline-neutral-700">
                    <div
                        class="rounded-full inset-0 absolute outline outline-neutral-700 flex items-center justify-center space-y-1 flex-col"
                    >
                        <span class="text-4xl font-bold">50M+</span>
                        <h3 class="text-lg text-neutral-400">
                            Emails Analyzed Daily
                        </h3>
                    </div>
                </div>
                <div class="relative outline outline-neutral-700">
                    <div
                        class="rounded-full inset-0 absolute outline outline-neutral-700 flex items-center justify-center space-y-1 flex-col"
                    >
                        <span class="text-4xl font-bold">24/7</span>
                        <h3 class="text-lg text-neutral-400">
                            Real-time Protection
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div
            class="w-full px-20 flex flex-col space-y-3 mt-20 items-center mb-20"
        >
            <h2 class="text-4xl font-medium">Privacy by Default</h2>
            <p class="text-neutral-400 text-center max-w-2xl">
                All your emails are encrypted end-to-end. Even we can't read
                them.
            </p>
            <div
                class="flex flex-col gap-2 bg-neutral-900 p-5 font-mono text-sm max-w-3xl w-full mt-8 privacy-section"
            >
                <div class="flex gap-2">
                    <span class="text-neutral-500">From:</span>
                    <span
                        class="encrypted-text"
                        data-text="john.doe@example.com"
                        >████████████████████</span
                    >
                </div>
                <div class="flex gap-2">
                    <span class="text-neutral-500">To:</span>
                    <span
                        class="encrypted-text"
                        data-text="jane.smith@company.com"
                        >█████████████████████</span
                    >
                </div>
                <div class="flex gap-2">
                    <span class="text-neutral-500">Subject:</span>
                    <span
                        class="encrypted-text"
                        data-text="Project Update - Q4 2025"
                        >████████████████████████</span
                    >
                </div>
                <div class="h-px bg-neutral-700 my-4"></div>
                <div class="flex flex-col gap-2">
                    <span class="encrypted-text" data-text="Hi Jane,"
                        >███████</span
                    >
                    <span class="encrypted-text" data-text="">█</span>
                    <span
                        class="encrypted-text"
                        data-text="I hope this email finds you well. I wanted to give you a quick update"
                        >████████████████████████████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="on our Q4 project progress. We've successfully completed the initial"
                        >█████████████████████████████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="phase and are now moving into the development stage."
                        >████████████████████████████████████████████████</span
                    >
                    <span class="encrypted-text" data-text="">█</span>
                    <span
                        class="encrypted-text"
                        data-text="The team has been working incredibly hard, and we're ahead of schedule"
                        >████████████████████████████████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="by about 2 weeks. Here are the key highlights:"
                        >███████████████████████████████████████████</span
                    >
                    <span class="encrypted-text" data-text="">█</span>
                    <span
                        class="encrypted-text"
                        data-text="- Security implementation: 95% complete"
                        >████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="- User interface design: Finalized and approved"
                        >███████████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="- Backend infrastructure: Testing phase"
                        >████████████████████████████████████████</span
                    >
                    <span
                        class="encrypted-text"
                        data-text="- Documentation: In progress"
                        >██████████████████████████████</span
                    >
                    <span class="encrypted-text" data-text="">█</span>
                    <span
                        class="encrypted-text"
                        data-text="Let me know if you'd like to schedule a meeting to discuss this further."
                        >████████████████████████████████████████████████████████████████████████</span
                    >
                    <span class="encrypted-text" data-text="">█</span>
                    <span class="encrypted-text" data-text="Best regards,"
                        >█████████████</span
                    >
                    <span class="encrypted-text" data-text="John">████</span>
                </div>
            </div>
        </div>
    </main>

    <style>
        .feature-dot-layer {
            background: radial-gradient(circle, #5e5e5e 2px, transparent 2px);
            background-size: 10px 10px;
            transform: rotate(45deg);
            rotate: x 50deg;
        }
        .feature-lines-layer {
            background-image: linear-gradient(#5e5e5e 1px, transparent 1px),
                linear-gradient(#5e5e5e 1px, transparent 1px);
            background-size: 10px 10px;
            transform: rotate(45deg);
            rotate: x 50deg;
        }
        .feature-grid-layer {
            background-image: linear-gradient(#5e5e5e 1px, transparent 1px),
                linear-gradient(90deg, #5e5e5e 1px, transparent 1px);
            background-size: 20px 20px; /* Abstand der Linien */
            transform: rotate(45deg);
            border: 1px solid #5e5e5e;
            rotate: x 50deg;
        }

        .layers:hover .layer-item:not(:hover) {
            opacity: 0.5;
            z-index: 15;
            transition: opacity 0.2s ease-in-out;
        }

        .layer-item {
            z-index: 5;
            background-color: transparent;
            transition: opacity 0.2s ease-in-out;
        }

        .text-box {
            transition: all 0.3s ease-in-out;
            opacity: 0.4;
        }

        .text-box.active {
            opacity: 1;
            border-color: #a3a3a3;
        }

        .encrypted-text {
            display: inline-block;
            color: #737373;
            transition: all 0.5s ease-in-out;
            font-family: monospace;
        }

        .encrypted-text.decrypted {
            color: #e5e5e5;
        }

        .privacy-section {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease-out;
        }

        .privacy-section.visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>

    <script>
        const dots = document.querySelector(
            ".feature-dot-layer",
        ) as HTMLDivElement;
        const lines = document.querySelector(
            ".feature-lines-layer",
        ) as HTMLDivElement;
        const grid = document.querySelector(
            ".feature-grid-layer",
        ) as HTMLDivElement;
        const textBoxes =
            document.querySelectorAll<HTMLDivElement>(".text-box");

        if (!dots || !lines || !grid) {
            throw new Error("Could not find feature layers");
        }

        const layers = [dots, lines, grid];
        let currentIndex = 0;

        const highlightLayer = (index: number) => {
            layers.forEach((layer, i) => {
                layer.style.opacity = i === index ? "1" : "0.3";
                layer.style.zIndex = i === index ? "20" : "5";
            });

            textBoxes.forEach((box, i) => {
                if (i === index) {
                    box.classList.add("active");
                } else {
                    box.classList.remove("active");
                }
            });
        };

        const cycleHighlight = () => {
            highlightLayer(currentIndex);
            currentIndex = (currentIndex + 1) % layers.length;
        };

        highlightLayer(0);
        setInterval(cycleHighlight, 3000);

        const privacySection = document.querySelector(
            ".privacy-section",
        ) as HTMLElement;
        const encryptedTexts =
            document.querySelectorAll<HTMLSpanElement>(".encrypted-text");

        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        privacySection.classList.add("visible");

                        setTimeout(() => {
                            encryptedTexts.forEach((text, index) => {
                                setTimeout(() => {
                                    const actualText =
                                        text.getAttribute("data-text") || "";
                                    let currentIteration = 0;

                                    const interval = setInterval(() => {
                                        text.textContent = actualText
                                            .split("")
                                            .map((char, charIndex) => {
                                                if (
                                                    charIndex < currentIteration
                                                ) {
                                                    return char;
                                                }
                                                const randomChar =
                                                    String.fromCharCode(
                                                        33 +
                                                            Math.floor(
                                                                Math.random() *
                                                                    94,
                                                            ),
                                                    );
                                                return randomChar;
                                            })
                                            .join("");

                                        if (
                                            currentIteration >=
                                            actualText.length
                                        ) {
                                            clearInterval(
                                                interval as unknown as number,
                                            );
                                            text.textContent = actualText;
                                            text.classList.add("decrypted");
                                        }

                                        currentIteration += 1;
                                    }, 30);
                                }, index * 50);
                            });
                        }, 500);

                        observer.unobserve(entry.target);
                    }
                });
            },
            { threshold: 0.2 },
        );

        if (privacySection) {
            observer.observe(privacySection);
        }
    </script>
</Layout>
