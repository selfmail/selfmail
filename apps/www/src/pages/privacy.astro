---
import "../styles/global.css";
import Layout from "../layouts/Layout.astro";

export const prerender = false;

const currentLocale = Astro.preferredLocale || Astro.currentLocale || "en";

let translations = {};
try {
	translations = await import(`../../i18n/${currentLocale}.json`);
} catch (error) {
	// Fallback to English if translation file doesn't exist
	try {
		translations = await import("../../i18n/en.json");
	} catch (fallbackError) {
		console.warn(`No translation file found for locale: ${currentLocale}`);
	}
}

// Translation function
const t = (key: string, fallback?: string): string => {
	const keys = key.split(".");
	let value: any = (translations as any).default || translations;
	for (const k of keys) {
		value = value?.[k];
	}
	return value || fallback || key;
};
---

<Layout>
	<div class="grid grid-cols-1 md:grid-cols-2 gap-0 max-w-4xl w-full">
		<!-- Header Section -->
		<div class="col-span-1 md:col-span-2 p-3 sm:p-4 space-y-2 sm:space-y-3">
			<h1 class="text-2xl sm:text-3xl md:text-4xl font-medium">{t("privacy.title")}</h1>
			<h2 class="text-xl sm:text-2xl font-medium">{t("privacy.subtitle")}</h2>
			<p class="text-sm sm:text-base text-neutral-600">{t("privacy.description")}</p>
		</div>

		<!-- Privacy Content -->
		<div class="col-span-1 md:col-span-2 p-3 sm:p-4 border border-neutral-200 flex flex-col space-y-4 sm:space-y-6">
			<!-- Data Storage Section -->
			<div class="space-y-2 sm:space-y-3">
				<h3 class="text-lg sm:text-xl font-medium">{t("privacy.sections.dataStorage.title")}</h3>
				<p class="text-sm sm:text-base text-neutral-600">{t("privacy.sections.dataStorage.description")}</p>
			</div>

			<!-- Data Usage Section -->
			<div class="space-y-2 sm:space-y-3">
				<h3 class="text-lg sm:text-xl font-medium">{t("privacy.sections.dataUsage.title")}</h3>
				<p class="text-sm sm:text-base text-neutral-600">{t("privacy.sections.dataUsage.description")}</p>
			</div>

			<!-- Data Rights Section -->
			<div class="space-y-2 sm:space-y-3">
				<h3 class="text-lg sm:text-xl font-medium">{t("privacy.sections.dataRights.title")}</h3>
				<p class="text-sm sm:text-base text-neutral-600">{t("privacy.sections.dataRights.description")}</p>
			</div>

			<!-- Contact Section -->
			<div class="space-y-2 sm:space-y-3">
				<h3 class="text-lg sm:text-xl font-medium">{t("privacy.sections.contact.title")}</h3>
				<p class="text-sm sm:text-base text-neutral-600">{t("privacy.sections.contact.description")}</p>
			</div>
		</div>

		<!-- Back to Home -->
		<div class="col-span-1 md:col-span-2 p-3 sm:p-4">
			<a 
				href="/" 
				class="inline-block bg-neutral-900 hover:bg-neutral-800 text-white px-4 py-2 rounded-xl text-sm sm:text-base font-medium transition-colors"
			>
				← Back to Home
			</a>
		</div>

		<!-- Footer -->
		<div class="col-span-1 p-2 md:col-span-2 border h-min border-neutral-200 text-sm text-neutral-500">
			Open-source email infrastructure • Built with Astro and TypeScript
		</div>
	</div>
</Layout>